#ifndef EP2003_84_FIG1L_H
#define EP2003_84_FIG1L_H

#include <vector>
#include <iostream>

class ep2003_084_Fig1L{
 public:
 
  //using digitizer
  static const Int_t nPoints = 21;
  Double_t xVals[nPoints] = {0.014779116465863329,
			     0.024176706827309158,
			     0.03461847389558223,
			     0.04506024096385533,
			     0.054457831325301104,
			     0.06489959839357418,
			     0.07534136546184733,
			     0.08473895582329302,
			     0.09518072289156612,
			     0.10979919678714847,
			     0.12963855421686735,
			     0.1505220883534136,
			     0.17036144578313242,
			     0.1902008032128514,
			     0.22465863453815252,
			     0.2747791164658635,
			     0.3499598393574296,
			     0.45020080321285116,
			     0.5504417670682729,
			     0.6496385542168672,
			     0.749879518072289};
  
  Double_t yVals[nPoints] = {522.561874933373,
			     301.03434256927454,
			     199.03588600014234,
			     147.6121279351077,
			     106.99192136266706,
			     86.98450383896477,
			     69.11267970278135,
			     56.19038265054258,
			     45.68281878789116,
			     37.135594721899096,
			     26.90827108015079,
			     20.413523643495008,
			     14.79153981547273,
			     11.482434709596436,
			     8.127694741337956,
			     4.570354185842621,
			     2.627767333911709,
			     1.1726753380002704,
			     0.32306682590227054,
			     0.15805085512606515,
			     0.07053224901775783};
  
  Double_t bins[nPoints+1] = {0.009558232931726862,
			      0.019999999999999934,
			      0.03044176706827298, 
			      0.03983935742971878, 
			      0.05028112449799188, 
			      0.06072289156626495, 
			      0.07012048192771073, 
			      0.08056224899598383, 
			      0.0899598393574296, 
			      0.09935742971887532,
			      0.12024096385542152,
			      0.1400803212851405, 
			      0.15991967871485888,
			      0.1797590361445783, 
			      0.19959839357429718,
			      0.24971887550200791,
			      0.2998393574297188, 
			      0.4000803212851404, 
			      0.5003212851405622, 
			      0.6005622489959838, 
			      0.6997590361445782, 
			      0.7999999999999998};

  
  static const Int_t nCorrPoints = 58;
  
  Double_t xCorrVals[nCorrPoints] = {0.015823293172689934,
				     0.024176706827308464,
				     0.031485943775099584,
				     0.03879518072289079, 
				     0.04401606425702731, 
				     0.05028112449799113, 
				     0.05445783132530041, 
				     0.058634538152609716,
				     0.06385542168674618, 
				     0.06907630522088276, 
				     0.07429718875501928, 
				     0.08056224899598313, 
				     0.08682730923694704, 
				     0.09309236947791083, 
				     0.09831325301204741, 
				     0.10875502008032051, 
				     0.10353413654618399, 
				     0.1150200803212843, 
				     0.12128514056224804,
				     0.12859437751003944,
				     0.13799196787148515,
				     0.1463453815261037, 
				     0.1526104417670675, 
				     0.15783132530120403,
				     0.1630522088353405, 
				     0.1693172690763044, 
				     0.17558232931726825,
				     0.1860240963855413, 
				     0.1943775100401598, 
				     0.2048192771084329, 
				     0.2131726907630514, 
				     0.22361445783132444,
				     0.2382329317269068, 
				     0.25702811244979834,
				     0.27373493975903535,
				     0.286265060240963, 
				     0.30088353413654534,
				     0.31863453815260956,
				     0.3405622489959831, 
				     0.35309236947791084,
				     0.3760642570281117, 
				     0.3927710843373486, 
				     0.4136546184738948, 
				     0.42827309236947714,
				     0.4491566265060232, 
				     0.4700401606425694, 
				     0.4930120481927703, 
				     0.5138955823293163, 
				     0.5452208835341357, 
				     0.5723694779116459, 
				     0.5974297188755011, 
				     0.6204016064257021, 
				     0.6496385542168666, 
				     0.6830522088353406, 
				     0.7102008032128504, 
				     0.7331726907630514, 
				     0.7551004016064251, 
				     0.7749397590361438}; 
  
  Double_t yCorrVals[nCorrPoints] = {1.0943017352428583,
				     1.0848172564471725,
				     1.0894900356141548,
				     1.0894458336490618,
				     1.0894142608168522,
				     1.0893763734182011,
				     1.0846341340203582,
				     1.0940428380187417,
				     1.1034452274506834,
				     1.0986966734863985,
				     1.0986651006541892,
				     1.098627213255538,
				     1.1033063069889621,
				     1.1079854007223866,
				     1.117387790154328,
				     1.1361925690182113,
				     1.1267901795862696,
				     1.1361546816195602,
				     1.1313998130888334,
				     1.1219216488595896,
				     1.1265817988936881,
				     1.1312482634942287,
				     1.135927357227653,
				     1.1453297466595944,
				     1.1547321360915361,
				     1.164128210957036,
				     1.1688073046904601,
				     1.1734611401581168,
				     1.173410623626582,
				     1.1780644590942386,
				     1.1827309236947792,
				     1.187384759162436,
				     1.18729635523225,
				     1.1871826930362963,
				     1.1870816599732263,
				     1.1822889040438485,
				     1.1822005001136624,
				     1.1773761713520752,
				     1.1772435654567959,
				     1.172450809527418,
				     1.153443964537395,
				     1.1344750069460234,
				     1.115480791088884,
				     1.1059584248945469,
				     1.0869642090374079,
				     1.0679699931802684,
				     1.0489631481902455,
				     1.0346859134651818,
				     1.0109115708115486,
				     0.9777285241595315,
				     0.949275087772474,
				     0.9255512616503754,
				     0.8923555858654749,
				     0.8166818216261278,
				     0.7551968881816581,
				     0.6984541941350312,
				     0.6511517769189972,
				     0.613295951099998};

  TH1F* corrHist_p;

  ep2003_084_Fig1L();
  ~ep2003_084_Fig1L();

  Int_t getNPoints(){return nPoints;}
  Bool_t checkInVal(Int_t inVal);
  Double_t getPointXVal(Int_t inVal);
  Double_t getPointYVal(Int_t inVal);
  std::vector<Double_t> getBins();
  Double_t getCorrVal(Double_t inVal);
  TH1F* getHist();
};


ep2003_084_Fig1L::ep2003_084_Fig1L()
{
  Double_t binsTemp[nCorrPoints+1];
  binsTemp[0] = bins[0];
  binsTemp[nCorrPoints] = bins[nPoints];
  
  for(Int_t cI = 0; cI < nCorrPoints-1; ++cI){
    binsTemp[cI+1] = (xCorrVals[cI] + xCorrVals[cI+1])/2.;
  }

  corrHist_p = new TH1F("corrHist_h", "", nCorrPoints, binsTemp);

  for(Int_t cI = 0; cI < nCorrPoints; ++cI){
    corrHist_p->SetBinContent(cI+1, yCorrVals[cI]);
    corrHist_p->SetBinError(cI+1, 0);
  }

  return ;
}

ep2003_084_Fig1L::~ep2003_084_Fig1L()
{
  delete corrHist_p;
  return;
}

Bool_t ep2003_084_Fig1L::checkInVal(Int_t inVal)
{
  if(inVal < 0 || inVal >= nPoints){
    std::cout << "requested point \'" << inVal << "\' is outside accepted range 0-" << nPoints-1 << ". return -1" << std::endl;
    return false;
  }
  return true;
}


Double_t ep2003_084_Fig1L::getPointXVal(Int_t inVal)
{
  if(!checkInVal(inVal)) return -1;
  else return xVals[inVal];
}


Double_t ep2003_084_Fig1L::getPointYVal(Int_t inVal)
{
  if(!checkInVal(inVal)) return -1;
  else return yVals[inVal];
}


std::vector<Double_t> ep2003_084_Fig1L::getBins()
{
  std::vector<Double_t> binsV;
  for(Int_t i = 0; i < nPoints+1; ++i){binsV.push_back(bins[i]);}
  return binsV;
}


Double_t ep2003_084_Fig1L::getCorrVal(Double_t inVal)
{
  if(inVal < bins[0] || inVal > bins[nPoints]){
    std::cout << "Given input \'" << inVal << "\' is outside range " << bins[0] << "-" << bins[nPoints] << " and invalid for correction. return -999" << std::endl;
    return -999.;
  }

  return corrHist_p->Interpolate(inVal);
}


TH1F* ep2003_084_Fig1L::getHist(){return corrHist_p;}

#endif
